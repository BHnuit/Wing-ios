# ğŸ—ºï¸ Wing iOS Native - å¼€å‘è·¯çº¿å›¾ (Roadmap)

> **å½“å‰çŠ¶æ€**: Phase 10 (å‘å¸ƒå‡†å¤‡) - è§„åˆ’ä¸­
> **ç›®æ ‡ç¯å¢ƒ**: iOS 26.2+ | Swift 6.2 | SwiftUI | SwiftData
> **æœ€åæ›´æ–°**: 2026-02-13
> **Xcode**: 26.3

## ğŸ“Œ é¡¹ç›®æ¦‚è¿°
Wing æ˜¯ä¸€ä¸ªä» React/TypeScript é‡æ„ä¸ºåŸç”Ÿ iOS çš„ AI é©±åŠ¨æ—¥è®°åº”ç”¨ã€‚
å®ƒåˆ©ç”¨ **SwiftData** è¿›è¡Œæœ¬åœ°æŒä¹…åŒ–ï¼Œä½¿ç”¨ **SwiftUI** æ„å»ºä»é›¶å¼€å§‹çš„ç•Œé¢ï¼Œå¹¶é›†æˆ **LLM (Gemini/OpenAI)** è¿›è¡Œæ—¥è®°æ™ºèƒ½åˆæˆã€‚

---

## ğŸ—ï¸ æ¶æ„è§„èŒƒ (Cursor æŒ‡å—)

*   **è®¾è®¡æ¨¡å¼**: MVVM (Model-View-ViewModel) + Services (åŸºäº Actor)ã€‚
*   **å¹¶å‘æ¨¡å‹**: ä¸¥æ ¼ä½¿ç”¨ `async/await`ã€‚ä½¿ç”¨ `Task` å’Œ `Actor` ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚
*   **æœ¬åœ°åŒ–**: ä½¿ç”¨ `L()` è¾…åŠ©å‡½æ•° + `SettingsManager` å®ç°åŠ¨æ€åˆ‡æ¢ã€‚
*   **æ•°æ®å±‚**:
    *   **SwiftData**: ä½¿ç”¨ `@Model` è¿›è¡ŒæŒä¹…åŒ–ã€‚
    *   **å›¾ç‰‡å¤„ç†**: å¿…é¡»ä½¿ç”¨ `@Attribute(.externalStorage) var data: Data?` é˜²æ­¢æ•°æ®åº“è†¨èƒ€ã€‚
    *   **ID**: å§‹ç»ˆä½¿ç”¨ `UUID`ã€‚
*   **å®‰å…¨æ€§**: API Keys å¿…é¡»å­˜å‚¨åœ¨ **Keychain** ä¸­ï¼ˆé€šè¿‡ `KeychainHelper`ï¼‰ï¼Œä¸¥ç¦å­˜å‚¨åœ¨ UserDefaults æˆ–ä»£ç ä¸­ã€‚
*   **UI**: çº¯ SwiftUIã€‚ä½¿ç”¨ `NavigationStack` è¿›è¡Œè·¯ç”±ç®¡ç†ã€‚
*   **æµ‹è¯•**:
    *   `@Test` (Swift Testing) ç”¨äºé€»è¾‘/æ¨¡å‹æµ‹è¯•ã€‚
    *   `XCTest` ç”¨äº UI/é›†æˆæµ‹è¯•ã€‚

---

## âœ… Phase 1: ç¯å¢ƒä¸åˆå§‹é…ç½® (å·²å®Œæˆ)
- [x] **é¡¹ç›®åˆå§‹åŒ–**: Xcode 26.2, Swift 6.2.
- [x] **é…ç½®**: å»ºç«‹ iOS ç¯å¢ƒä¸‹çš„ `.cursorrules`.
- [x] **Git**: ä»“åº“åˆå§‹åŒ–ä¸æ¸…ç†.

## âœ… Phase 2: æ•°æ®å±‚åŸºç¡€ (å·²å®Œæˆ)
- [x] **æ ¸å¿ƒæ¨¡å‹ (`WingModels.swift`)**:
    - `RawFragment` (å«å¤–éƒ¨å›¾ç‰‡å­˜å‚¨).
    - `DailySession` (é…ç½®çº§è”åˆ é™¤).
    - `WingEntry` (åŒ…å«ç”¨äº JSON ç»“æ„çš„è®¡ç®—å±æ€§).
    - `AppSettings` & `Memory` æ¨¡å‹.
- [x] **æ¨¡å‹å®¹å™¨**: åœ¨ `WingApp.swift` ä¸­é…ç½®.
- [x] **éªŒè¯ (`ModelTests.swift`)**:
    - CRUD æ“ä½œéªŒè¯.
    - å›¾ç‰‡å¤–éƒ¨å­˜å‚¨éªŒè¯.
    - çº§è”åˆ é™¤éªŒè¯.
    - å¤æ‚æ•°æ®ç±»å‹ (JSON) éªŒè¯.

---

## âœ… Phase 3: æ ¸å¿ƒæœåŠ¡ (å¤§è„‘) (å·²å®Œæˆ)
**ç›®æ ‡**: å°† `aiService.ts` é€»è¾‘è¿ç§»åˆ° Swift Actorsï¼Œå¹¶å»ºç«‹å®‰å…¨çš„åå¥½è®¾ç½®ã€‚

- [x] **3.1 å®‰å…¨å±‚** (`Utils/KeychainHelper.swift`)
    - [x] åˆ›å»º `KeychainHelper` ç±» (Singleton/Static).
    - [x] å®ç°åŸºäº `kSecClassGenericPassword` çš„å¢åˆ æ”¹æŸ¥.
- [x] **3.2 AI æœåŠ¡å¼•æ“** (`Services/AIService.swift`)
    - [x] å®šä¹‰ `AIConfig` ç»“æ„ (API Key, Model, Provider).
    - [x] åˆ›å»º `actor AIService`.
    - [x] å®ç°æµå¼åˆæˆ `synthesizeJournalStream(fragments:config:) -> AsyncThrowingStream`.
    - [x] ç§»æ¤ Prompt Engineering é€»è¾‘ (è‡ª `aiService.ts`).
    - [x] å®ç° SSE (Server-Sent Events) æ‰‹åŠ¨è§£æ (OpenAI & Gemini).
- [x] **3.3 ç”¨æˆ·è®¾ç½®ä¸ UI**
    - [x] å®ç° `SettingsManager` (SwiftData + Keychain).
    - [x] åˆ›å»º `SettingsEntryView` ç”¨äº AI é…ç½®.
    - [x] éªŒè¯æŒä¹…åŒ–ä¸å®‰å…¨æ€§.

> ğŸ“– æŠ€æœ¯å›é¡¾: [phase3-retrospective.md](.agent/memories/phase3-retrospective.md)

---

## âœ… Phase 4: UI æ¶æ„ (éª¨æ¶) (å·²å®Œæˆ)
**ç›®æ ‡**: å»ºç«‹å¯¼èˆªç³»ç»Ÿå’Œåº”ç”¨ç»“æ„ã€‚

- [x] **4.1 å¯¼èˆªåŸºç¡€è®¾æ–½**
    - [x] å®šä¹‰ `AppRoute` æšä¸¾ (Chat, JournalDetail, Settings ç­‰).
    - [x] åˆ›å»º `NavigationManager` (`@Observable` class) ç”¨äºçŠ¶æ€ç®¡ç†.
- [x] **4.2 ä¸» Tab è§†å›¾**
    - [x] Tab 1: **å½“ä¸‹ (Today)** - èŠå¤©/è®°å½•ç•Œé¢.
    - [x] Tab 2: **å›å¿† (Journal)** - å†å²åˆ—è¡¨.
    - [x] Tab 3: **è®¾ç½® (Settings)**.

> ğŸ“– æŠ€æœ¯å›é¡¾: [phase4-retrospective.md](.agent/memories/phase4-retrospective.md)

---

## âœ… Phase 5: è¾“å…¥å·¥ä½œæµ (å½“ä¸‹) (å·²å®Œæˆ)
**ç›®æ ‡**: å¤åˆ»ç±»èŠå¤©å¼çš„è®°å½•ä½“éªŒã€‚

- [x] **5.1 èŠå¤©ç•Œé¢** (`Views/Chat/ChatView.swift`)
    - [x] ä½¿ç”¨ `@Query` è·å–ä»Šæ—¥çš„ `DailySession`.
    - [x] å®ç° `ScrollView` + `LazyVStack` ä»¥æå‡æ€§èƒ½.
    - [x] æ¸²æŸ“ `FragmentBubble` è§†å›¾ (æ–‡æœ¬ & å›¾ç‰‡).
- [x] **5.2 è¾“å…¥åŒºåŸŸ**
    - [x] æ–‡æœ¬è¾“å…¥æ¡† (è‡ªé€‚åº”é«˜åº¦).
    - [ ] è¾“å…¥ä½“éªŒä¼˜åŒ– (å…‰æ ‡ä½ç½®ã€æ¢è¡Œé€»è¾‘ã€é”®ç›˜é®æŒ¡) - *é—ç•™ä»»åŠ¡*.
    - [x] **ç…§ç‰‡é€‰æ‹©å™¨**: é›†æˆ `PhotosPicker` (SwiftUI Native).
    - [x] **è§¦æ„Ÿåé¦ˆ**: å‘é€æ—¶å¢åŠ  `UIImpactFeedbackGenerator`.
    - [x] **æ—¥æœŸå¯¼èˆª**: å¥å£®çš„æ—¥æœŸåˆ‡æ¢ä¸æ—¥å† (`DateNavigator.swift`).

> ğŸ“– æŠ€æœ¯å›é¡¾: [phase5-retrospective.md](.agent/memories/phase5-retrospective.md)

---

## âœ… Phase 6: è¾“å‡ºå·¥ä½œæµ (æ—¥è®°) (å·²å®Œæˆ)
**ç›®æ ‡**: æ¸²æŸ“ AI åˆæˆçš„æ—¥è®°æ¡ç›®ã€‚

- [x] **6.1 Markdown æ¸²æŸ“**
    - [x] å®ç°åŸç”Ÿ `AttributedString(markdown:)` è§£æå™¨ï¼ˆå«æ®µè½åˆ†å‰²ï¼‰.
    - [x] æ ·å¼åŒ–æ ‡é¢˜ã€åˆ—è¡¨ã€åŠ ç²—ä»¥åŒ¹é… Wing çš„ç¾å­¦.
- [x] **6.2 æ—¥è®°è¯¦æƒ…** (`Views/Journal/JournalDetailView.swift`)
    - [x] å°é¢å›¾åŒºåŸŸï¼ˆæ”¯æŒç‚¹å‡»ç¼©æ”¾ï¼‰.
    - [x] æ˜¾ç¤ºå…ƒæ•°æ®: æ ‡é¢˜ã€æ—¥æœŸ (å« Fallback).
    - [x] æ˜¾ç¤º AI æ´å¯Ÿ ("çŒ«å¤´é¹°çš„è¯„è®º").
    - [x] æ¸²æŸ“ Markdown æ­£æ–‡.
- [x] **6.3 æ—¥è®°åˆæˆ**
    - [x] `JournalSynthesisService`: ç¼–æ’åˆæˆæµç¨‹.
    - [x] `AIService.synthesizeJournal`: å•æ¬¡è¯·æ±‚ JSON æ¨¡å¼.
    - [x] `SynthesisProgressView`: å¾ªç¯é¼“åŠ±è¯­ + æ—¶é—´é¢„ä¼°.
    - [x] **Fallback**: JSON è§£æå¤±è´¥æ—¶ â†’ ä¿å­˜ä¸º "æ— é¢˜æ—¥è®°".

> ğŸ“– æŠ€æœ¯å›é¡¾: [phase6-retrospective.md](.agent/memories/phase6-retrospective.md)

---

## âœ… Phase 7: è®¾ç½®ä¸æ‰“ç£¨ (å·²å®Œæˆ)
**ç›®æ ‡**: å®Œæˆè®¾ç½® UI å¹¶è¿›è¡Œå‘å¸ƒå‰çš„æ‰“ç£¨ã€‚

- [x] **7.1 è®¾ç½®è§†å›¾**
    - [x] AI æœåŠ¡å•†é…ç½® (API Key è¾“å…¥ -> Keychain).
    - [ ] å®Œå–„æ¨¡å‹åˆ—è¡¨ä¸æœåŠ¡å•†é…ç½® (OpenAI/Gemini/DeepSeek é¢„è®¾åˆ—è¡¨) - *é—ç•™ä»»åŠ¡*.
    - [x] è®¾ç½® UI é‡æ„ (æ¨¡å—åŒ–åˆ†åŒº).
- [x] **7.2 æ•°æ®ç®¡ç†**
    - [x] å¯¼å‡º/å¤‡ä»½é€»è¾‘ (å…¨é‡ JSON å¯¼å‡º).
    - [x] å•ç¯‡å¯¼å‡º (Markdown).
- [x] **7.3 ç»†èŠ‚æ‰“ç£¨**
    - [x] App å›¾æ ‡ä¸èµ„æºé…ç½®.
    - [x] æ·±è‰²æ¨¡å¼ä¼˜åŒ–.
    - [x] è§¦æ„Ÿåé¦ˆé›†æˆ.

---

## âœ… Phase 8: AI Agent ä¸é«˜çº§ç‰¹æ€§ (å·²å®Œæˆ)
**ç›®æ ‡**: æ·±åŒ– AI é›†æˆä¸ä¸ªæ€§åŒ–èƒ½åŠ›ã€‚

- [x] **8.1 é«˜çº§ä¸ªæ€§åŒ–**
    - [x] `WritingStyle` è®¾ç½® UI (ä¹¦ä¿¡ã€æ•£æ–‡ã€æŠ¥å‘Š).
    - [ ] è‡ªå®šä¹‰ Prompt ç¼–è¾‘å™¨ (`writingStylePrompt`, `insightPrompt` - æ–‡é£ä¸æ´å¯Ÿæ”¯æŒè‡ªå®šä¹‰) - *é—ç•™ä»»åŠ¡*
- [x] **8.2 AI Agent èƒ½åŠ›**
    - [x] é•¿æœŸè®°å¿† (è¯­ä¹‰/æƒ…æ™¯/ç¨‹åºæ€§è®°å¿†æå–).
    - [x] ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„ RAG æ£€ç´¢ (ç”¨äºæ—¥è®°åˆæˆ).
- [x] **8.3 é«˜çº§æ•°æ®ç‰¹æ€§**
    - [x] å¯¼å…¥é€»è¾‘ (ä» JSON å¤‡ä»½æ¢å¤).
    - [x] è®°å¿†æ•´åˆä¸ç®¡ç† UI.
    - [ ] iCloud åŒæ­¥ (CloudKit é›†æˆ) - *æš‚ç¼“*

---

## âœ… Phase 9: UI ä¼˜åŒ–ä¸é«˜çº§è®¾ç½® (å·²å®Œæˆ)
**ç›®æ ‡**: å®ç°å®Œæ•´çš„è®¾ç½®ã€å¯è§†åŒ–åŠŸèƒ½åŠå¤šè¯­è¨€æ”¯æŒã€‚

- [x] **9.1 æœ¬åœ°åŒ– (I18N)**
    - [x] **å¤šè¯­è¨€**: ä¸­æ–‡ (ç®€ä½“)ã€è‹±æ–‡ã€æ—¥æ–‡.
    - [x] **åŠ¨æ€åˆ‡æ¢**: æ— éœ€é‡å¯ App å³æ—¶åˆ·æ–°è¯­è¨€.
    - [x] **æ·±åº¦é›†æˆ**: AI Prompts, é”™è¯¯ä¿¡æ¯, å¯¼å‡ºå†…å®¹å‡å·²æœ¬åœ°åŒ–.
    - [x] **çº¿ç¨‹å®‰å…¨**: ä¿®å¤äº† `L()` åœ¨åå°çº¿ç¨‹çš„å¹¶å‘é—®é¢˜ (è‡ªåŠ¨å›é€€).
- [x] **9.2 æ•°æ®å¯è§†åŒ–**
    - [x] æ—¥å†çƒ­åŠ›å›¾ (`CalendarHeatmapView`) - æŒ‰æ—¥è¿½è¸ªæ´»è·ƒåº¦.
    - [x] ç»Ÿè®¡ä»ªè¡¨ç›˜ (æŒ¥åŠ¨æ¬¡æ•°, ç¾½æ¯›æ€»æ•°).
- [x] **9.3 é«˜çº§æ˜¾ç¤ºè®¾ç½®**
    - [ ] å­—ä½“é€‰æ‹© (å·²æ’é™¤).
    - [x] å­—å·ç¼©æ”¾ (å¤§/ä¸­/å°).
    - [x] ä¸»é¢˜åˆ‡æ¢ (è·Ÿéšç³»ç»Ÿ / æµ…è‰² / æ·±è‰²).
- [x] **9.4 é«˜çº§æ•°æ®ç®¡ç†**
    - [x] é€šç”¨æ–‡ä»¶å¯¼å…¥/æ›¿æ¢ (.json/.zip) - ä¸¥æ ¼åŒºåˆ†æµç¨‹.
    - [x] æ–‡ä»¶å¤¹å¯¼å…¥ (iOS Files é›†æˆ).
    - [x] "æ¸…ç©ºæ‰€æœ‰æ•°æ®" (å¸¦ä¸¥æ ¼ç¡®è®¤).
- [x] **9.5 è®°å¿†é›†æˆ**
    - [x] RAG é›†æˆ: åˆæˆæ—¶çš„æ£€ç´¢é€»è¾‘.
    - [x] è®°å¿†æ‰‹åŠ¨ç®¡ç† (åˆ é™¤/åˆå¹¶ UI).

> ğŸ“– æŠ€æœ¯å›é¡¾: [phase9-retrospective.md](.agent/memories/phase9-retrospective.md)

---

## ğŸ—ºï¸ Phase 10: å‘å¸ƒå‡†å¤‡ (è§„åˆ’ä¸­)
**ç›®æ ‡**: App Store æäº¤å‰çš„æœ€ç»ˆå‡†å¤‡ä¸æ–°ç”¨æˆ·å¼•å¯¼ã€‚

- [ ] **10.1 æ–°ç”¨æˆ·å¼•å¯¼ (Onboarding)**
    - [ ] **æ¬¢è¿æ—¥è®° (Welcome Entry)**: é¦–æ¬¡å¯åŠ¨è‡ªåŠ¨ç”Ÿæˆä¸€ç¯‡ä»‹ç» Wing åŠŸèƒ½çš„æ—¥è®°.
    - [ ] **å¯åŠ¨æ•™ç¨‹**: ç®€å•çš„åŠŸèƒ½å¼•å¯¼é¡µ (Onboarding Slides).
    - [ ] **é«˜çº§ä¸ªæ€§åŒ–è¡¥å…¨**: å®ç°è‡ªå®šä¹‰ Prompt ç¼–è¾‘å™¨ (`writingStylePrompt`, `insightPrompt`).
    - [ ] **AI é…ç½®å®Œå–„**: è¡¥å……å„æœåŠ¡å•†çš„ä¸»æµæ¨¡å‹é¢„è®¾åˆ—è¡¨.
    - [ ] **è¾“å…¥ä½“éªŒæ‰“ç£¨**: ä¼˜åŒ–é•¿æ–‡æœ¬è¾“å…¥æ—¶çš„æ»šåŠ¨ã€å…‰æ ‡åŠé”®ç›˜äº¤äº’ä½“éªŒ.
- [ ] **10.2 App Store èµ„æº**
    - [ ] App Icon (ç”Ÿäº§çº§å“è´¨).
    - [ ] å•†åº—æˆªå›¾ (EN/ZH/JA å¤šè¯­è¨€ç‰ˆæœ¬).
    - [ ] éšç§æ”¿ç­– URL.
- [ ] **10.3 æœ€ç»ˆæ‰“ç£¨**
    - [ ] å¯åŠ¨å±åŠ¨ç”» (Launch Screen).
    - [ ] æ€§èƒ½åˆ†æ (ä½¿ç”¨ Instruments).
    - [ ] å†…å­˜æ³„æ¼æ£€æŸ¥.
- [ ] **10.4 TestFlight**
    - [ ] æ„å»ºä¸å½’æ¡£ (Archive).
    - [ ] ä¸Šä¼ è‡³ App Store Connect.

## ğŸ“ å¼€å‘è€…æŒ‡å—

### å·¥ä½œæµ
1. **é˜…è¯»ä¸Šä¸‹æ–‡**: æ£€æŸ¥æ­¤è·¯çº¿å›¾ç¡®è®¤å½“å‰é˜¶æ®µ.
2. **å‚è€ƒ Web ä»£ç **: æŸ¥çœ‹ `Wing-main` æ–‡ä»¶é€»è¾‘, ä½¿ç”¨ Swift æ¨¡å¼é‡å†™.
3. **ä½¿ç”¨å·¥ä½œæµ**: è¿è¡Œ `/add-service` æ·»åŠ æ–°æœåŠ¡.
4. **éªŒè¯**: é‡å¤§å˜æ›´åè¿è¡Œæµ‹è¯•.

### æŠ€æœ¯å›é¡¾ (Retrospectives)
æ¯ä¸ªé˜¶æ®µçš„å›é¡¾æ–‡æ¡£å‡ä½äº `.agent/memories/`:
- `phase3-retrospective.md` - AI Service, Keychain, SSE
- `phase4-retrospective.md` - Navigation, Tab Architecture
- `phase5-retrospective.md` - DateNavigator, Image Compression
- `phase6-retrospective.md` - Swift 6 Concurrency, SwiftData Isolation
- `phase7-retrospective.md` - Settings Modularization, Dark Mode
- `phase8-retrospective.md` - Memory RAG, Prompt Engineering
- `phase9-retrospective.md` - Localization, Thread Safety, Advanced Settings